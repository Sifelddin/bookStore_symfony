{% extends 'admin.html.twig' %}

{% block title %}Book
{% endblock %}

{% block body %}
	<div class="min-h-fit  sm:justify-center items-center pt-6 sm:pt-0 bg-gray-100 col-span-4">
		<div class="flex flex-col  mt-6 px-6 py-4 bg-white shadow-md overflow-hidden sm:rounded-lg m-10">
                {% if items |length > 0 %}
			<div class="grid">
				<table class="divide-y divide-gray-200 col-span-1">
                    <thead class='mb-2'>
                        <tr class='grid grid-cols-8 gap-4'>
                            
                            <th class='text-center col-span-1'>Titre</th>
                            <th class='text-center col-span-1'>Editeur</th>
                            <th class='text-center col-span-1'>Prix unitaire</th>
                            <th class='text-center col-span-4'>Quantit√©</th>
                            <th class='text-center col-span-1'>Prix</th>
                            <th class="col-span-1"></th>
                        </tr>
                    </thead>
                    <tbody>

                    {% set totalHT = 0 %} 
                        {% set TVA = 0 %} 
                    {% for item in items %}
                        <tr class='my-2 grid grid-cols-8 gap-4'>
                            {# <td><div class="flex flex-col col-span-1">
                                <img src={{ asset('uploads/images/' ~ item.products.photo)}} alt={{ item.products.photo }}></div>
                            </td> #}
                            <td class='text-center col-span-1'>{{ item.products.title }}</td>  
                            <td class='text-center col-span-1'>{{ item.products.supplier }}</td>
                            <td class='text-center col-span-1'>{{ item.products.price * 1.20 }}</td>
                            
                            <td class='mt-1 text-right col-span-1'>
                                <a href="{{path('minus_panier',{'id': item.products.id})}}" class="focus:outline-none text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 mr-2 mb-2 dark:bg-red-600 dark:hover:bg-red-700 dark:focus:ring-red-900">-</a>
                            </td>
                            <td class='mt-1 text-center col-span-1'>   {{ item.quantity}}</td>
                            <td class='mt-1 text-left col-span-1'>
                                <a href="{{path('plus_panier',{'id': item.products.id})}}" class="ml-3 focus:outline-none text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 font-medium rounded-lg text-sm px-5 py-2.5 mr-2 mb-2 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800">+</a>   
                            </td>
                            <td class="w-10 text-left col-span-1"> <!-- Delete button -->
                                <a href="{{path('remove_panier',{'id': item.products.id})}}" class="flex space-x-2 items-center px-3 py-2 bg-red-600 hover:bg-red-800  rounded-md drop-shadow-md">
                                    <svg class="fill-white" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="20" height="20"
                                        viewBox="0 0 24 24">
                                        <path
                                            d="M 10 2 L 9 3 L 3 3 L 3 5 L 21 5 L 21 3 L 15 3 L 14 2 L 10 2 z M 4.3652344 7 L 5.8925781 20.263672 C 6.0245781 21.253672 6.877 22 7.875 22 L 16.123047 22 C 17.121047 22 17.974422 21.254859 18.107422 20.255859 L 19.634766 7 L 4.3652344 7 z">
                                        </path>
                                    </svg>
                                </a>
                            </td>
                            <td class='text-center col-span-1'>{{ (item.products.price * 1.20) * item.quantity}}</td>
                        </tr>
                    {% set TVA = TVA + ((item.products.price * 0.20) * item.quantity) %}    
                    {% set totalHT = totalHT + (item.products.price * item.quantity) %}                             
                    {% endfor %}
                    </tbody>
                    <tfoot>
                        <tr class='mt-2 grid grid-cols-8 gap-4'>
                            <td class="text-left col-span-6"></td>
                            <td class="text-right col-span-1">prix total HT :</td>
                            <td class="text-center col-span-1">{{totalHT}}</td>
                        </tr>
                        <tr class='mt-2 grid grid-cols-8 gap-4'>
                            <td class="text-left col-span-6"></td>
                            <td class="text-right col-span-1">TVA :</td>
                            <td class="text-center col-span-1">{{TVA}}</td>
                        </tr>
                            <tr class='mt-2 grid grid-cols-8 gap-4'>
                            <td class="text-left col-span-6"></td>
                            <td class="text-right col-span-1">prix total :</td>
                            <td class="text-center col-span-1">{{totalHT + TVA}}</td>
                        </tr>
                    </tfoot>

               
				</table>	
			</div>
			<div class='flex justify-center items-center  mt-5'>
                <a class=" px-4 py-2 mt-4 bg-green-800 border border-transparent rounded-md font-semibold text-sm text-white uppercase tracking-widest hover:bg-green-700 active:bg-gray-900 focus:outline-none focus:border-gray-900 focus:ring ring-gray-300 disabled:opacity-25 transition ease-in-out duration-150 disabled" disabled="" href="{{ path('app_api') }}"  >Valider panier</a>
			</div>
            {% else %}
            <p  class='flex justify-center items-center my-5 text-2xl'>Votre panier est vide</p>
            <div class='flex justify-center items-center  mt-5'>
		        <a class="flex justify-center items-center px-4 py-2 mt-4 bg-gray-700 border border-transparent rounded-md font-semibold text-sm text-white uppercase tracking-widest hover:bg-gray-900 active:bg-gray-900 focus:outline-none focus:border-gray-900 focus:ring ring-gray-300 disabled:opacity-25 transition ease-in-out duration-150" href="{{ path('app_catalogue') }}">back to list</a>
			</div>
            {% endif %}
		</div>
	</div>
{% endblock %}
